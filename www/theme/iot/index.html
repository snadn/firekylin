{% extends './layout.html' %}

{% block title %}
  {% if source == 'wx' %}
    {% if tag %}
    标签-{{tag}}
    {% elif cate %}
    分类-{{cate}}
    {% else %}
    {{options.title}}
    {% endif %}
  {% else %}
    {{options.title}}
  {% endif %}
{% endblock %}

{% block headers -%}
<link rel="canonical" href="{{site_url}}/{% if tag %}tag/{{pathname}}{% elif cate %}cate/{{pathname}}{% endif %}{% if pagination.currentPage > 1 %}?page={{pagination.currentPage}}{% endif %}" />
{%- endblock %}

{% block content %}
<section id="page-index">

  {% if source == "wx" %}

  {% elif tag %}
  <h1 class="intro">标签<a href="{{site_url}}{{http.url}}">{{tag}}</a>下的文章</h1>
  {% elif cate %}
  <h1 class="intro">分类<a href="{{site_url}}{{http.url}}">{{cate}}</a>下的文章</h1>
  {% endif %}

  {% for post in posts %}
  <article class="post">
    <div class="meta">
      <div>
        {% if post.user or post.author %}
          <span>作者:</span>
          <span class="author">
            {% set user = post.user %}
            {% if post.author %}
              {{post.author}}
            {% elif user.display_name %}
              {{user.display_name}}
            {% else %}
              {{user.name}}
            {% endif %}
          </span>
        {% endif %}
        <span class="date">{{think.datetime(post.create_time, 'MM月DD, YYYY')}}</span>
      </div>
      <div class="comment">
          <a href="/post/{{post.pathname}}.html#comments">{{post.comment_num}} comments</a>
      </div>
    </div>

    <h1 class="title">
      <a href="/post/{{post.pathname}}.html">{{post.title}}</a>
    </h1>

    {% if source != "wx" %}
    <div class="entry-content">
      {{post.summary | safe}}
      <p class="more">
          <a href="/post/{{post.pathname}}.html">阅读全文 »</a>
      </p>
    </div>
    {% endif %}

  </article>
  {% endfor %}
  {% include "./inc/pagination.html" %}
</section>
{% endblock %}
